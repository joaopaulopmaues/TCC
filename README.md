main.ipynb will call every necessary .py for updating the dataset and training the 2-Layer CNN model.
cuckoo_sandbox.py has every function for submitting files (send_file) for analysis and downloading the reports (download_report). Every simulation is done in a Windows VM.
encoding_dataset.py has functions for uniting the csvs from XRan dataset and encoding the csv into binary matrices. Each matrix is a csv without header and index that corresponds to one analysis report. Those matrices are the input of the CNN.
extract.py is a module dedicated to extract the API calls, dlls imported and mutexes operations from the JSON analysis report. The function data_extraction does that and write the data down in a line of NewWholeDatasetcsv.
downloader.py has the role of download the files which their hashes are found in the hasheslist.csv. It is responsible for calling the integrations to search for those hashes in online datasets such as Hybrid-Analysis, sandbox.pikker.ee, Tria.ge and VirusShare.
hash_enumerator.py is a module that has a function hash_searcher_integration that reads ransfamilies.csv and calls functions that searches for those families in repositories (in here just Valhalla). Then it first writes in a single csv with 2 columns. The left column is the sha256 hash (which is checked in VirusTotal) and the second is the family. The repeated ones are discarded and they're kept in the family that appear the less.
updater.py is a module that has a function that calls for 4 functions: hash_searcher_integration from hash_enumerator.py; then the download_all from downloader.py, to download the files for analysis; afterward send_file from cuckoo_sandbox.py; and finally data_extraction from extract.py. This way, updater.py concentrates the role of updating the dataset prepared for its encoding.